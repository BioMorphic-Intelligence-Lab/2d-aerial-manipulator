function C = coriolisMatrix(q,q_dot,m,l)
%CORIOLISMATRIX Function that returns the state and velocity dependent
%coriolis matrix of the equations of motion according to
% C = d/dt M - 1/2 * [q_dot.d/dx M; q_dot.d/dy M; q_dot.d/dTh M;
%                     q_dot.d/dTh1 M; ...; q_dot.d/dTh4 M]

%% Extract variables
tb = q(3);
t1 = q(4);
t2 = q(5);
t3 = q(6);
t4 = q(7);

xd = q_dot(1);
yd = q_dot(2);
tbd = q_dot(3);
t1d = q_dot(4);
t2d = q_dot(5);
t3d = q_dot(6);
t4d = q_dot(7);


%% Coriolis Effect on X
% Coriolis Effect on x due to x_dot, y_dot, th_dot
C11 = 0;
C12 = 0;
C13 = 0;
% Coriolis Effect on x due to th1_dot
C14 = -(1/2)*l*m*((7*sin(t1)+5*sin(t1+t2)+3*sin(t1+t2+t3)...
    +sin(t1+t2+t3+t4))*t1d+(5*sin(t1+t2)+3*sin(t1+t2+t3)...
    +sin(t1+t2+t3+t4))*t2d+3*sin(t1+t2+t3)*t3d+sin(t1+t2+t3+t4)*t3d...
    +sin(t1+t2+t3+t4)*t4d);
% Coriolis Effect on x due to th2_dot
C15 = -(1/2)*l*m*((5*sin(t1+t2)+3*sin(t1+t2+t3)+sin(t1+t2+t3+t4))*t1d...
    +(5*sin(t1+t2)+3*sin(t1+t2+t3)...
    +sin(t1+t2+t3+t4))*t2d+3*sin(t1+t2+t3)*t3d...
    +sin(t1+t2+t3+t4)*t3d+sin(t1+t2+t3+t4)*t4d);
% Coriolis Effect on x due to th3_dot 
C16 = 1/2*l*m*(-3*sin(t1+t2+t3)*(t1d+t2d+t3d)...
    -sin(t1+t2+t3+t4)*(t1d+t2d+t3d+t4d));
%Coriolis Effect on x due to th4_dot
C16 = -(1/2)*l*m*sin(t1+t2+t3+t4)*(t1d+t2d+t3d+t4d);

%% Coriolis Effect on y
% Coriolis Effect on y due to x_dot
C21 = 0; 
C22 = 0;
C23 = 0;
% Coriolis Effect on y due to th1_dot
C24 = -(1/2)*l*m*((7*cos(t1)+5*cos(t1+t2)+3*cos(t1+t2+t3)...
    +cos(t1+t2+t3+t4))*t1d+(5*cos(t1+t2)+3*cos(t1+t2+t3)...
    +cos(t1+t2+t3+t4))*t2d+3*cos(t1+t2+t3)*t3d+cos(t1+t2+t3+t4)*t3d...
    +cos(t1+t2+t3+t4)*t4d);
% Coriolis Effect on y due to th2_dot
C25 = -(1/2)*l*m*((5*cos(t1+t2)+3*cos(t1+t2+t3)...
    +cos(t1+t2+t3+t4))*t1d+(5*cos(t1+t2)+3*cos(t1+t2+t3)...
    +cos(t1+t2+t3+t4))*t2d+3*cos(t1+t2+t3)*t3d+cos(t1+t2+t3+t4)*t3d...
    +cos(t1+t2+t3+t4)*t4d);
% Coriolis Effect on y due to th3_dot
C26 = 1/2*l*m*(-3*cos(t1+t2+t3)*(t1d+t2d+t3d)...
    -cos(t1+t2+t3+t4)*(t1d+t2d+t3d+t4d));
% Coriolis Effect on y due to th4_dot
C27 = -(1/2)*l*m*cos(t1+t2+t3+t4)*(t1d+t2d+t3d+t4d);

%% Coriolis Effect on Theta
% Coriolis Effect on Theta due to x_dot, y_dot
C31 = 0;
C32 = 0;
% Coriolis Effect on Theta due to theta_dot
C33 = IDot(q,q_dot,l,m);
% Coriolis Effect on Theta due to th1_dot
C34 = 1/4*l^2*m*((24*cos(tb)+4*cos(tb+2*t1)+6*cos(tb-t2)+10*cos(tb+t2)...
    +4*cos(tb+2*t1+t2)+6*cos(tb-t3)+3*cos(tb-t2-t3)+6*cos(tb+t3)...
    +6*cos(tb+t2+t3)+3*cos(tb+2*t1+t2+t3)+2*cos(tb-t4)+2*cos(tb-t3-t4)...
    +cos(tb-t2-t3-t4)+2*cos(tb+t4)+2*cos(tb+t3+t4)+2*cos(tb+t2+t3+t4)...
    +cos(tb+2*t1+t2+t3+t4))*tbd-2*sin(tb/2)*(2*(4*sin(1/2*(tb+4*t1))...
    +4*sin(tb/2+2*t1+t2)+3*sin(tb/2+2*t1+t2+t3)+sin(tb/2+2*t1+t2+t3+t4))*t1d...
    +(-6*sin(1/2*(tb-2*t2))+10*sin(tb/2+t2)+4*sin(tb/2+2*t1+t2)...
    +6*sin(tb/2+t2+t3)+3*sin(tb/2+2*t1+t2+t3)-3*sin(1/2*(tb-2*(t2+t3)))...
    +2*sin(tb/2+t2+t3+t4)+sin(tb/2+2*t1+t2+t3+t4)...
    -sin(1/2*(tb-2*(t2+t3+t4))))*t2d-6*sin(1/2*(tb-2*t3))*t3d+6*sin(tb/2+t3)*t3d...
    +6*sin(tb/2+t2+t3)*t3d+3*sin(tb/2+2*t1+t2+t3)*t3d-3*sin(1/2*(tb-2*(t2+t3)))*t3d...
    +2*sin(tb/2+t3+t4)*t3d+2*sin(tb/2+t2+t3+t4)*t3d+sin(tb/2+2*t1+t2+t3+t4)*t3d...
    -2*sin(1/2*(tb-2*(t3+t4)))*t3d-sin(1/2*(tb-2*(t2+t3+t4)))*t3d...
    -2*sin(1/2*(tb-2*t4))*t4d+2*sin(tb/2+t4)*t4d+2*sin(tb/2+t3+t4)*t4d...
    +2*sin(tb/2+t2+t3+t4)*t4d+sin(tb/2+2*t1+t2+t3+t4)*t4d-2*sin(1/2*(tb...
    -2*(t3+t4)))*t4d-sin(1/2*(tb-2*(t2+t3+t4)))*t4d));
% Coriolis Effect on Theta due to th2_dot
C35 = 1/4*l^2*m*((15*cos(tb)+6*cos(tb-t2)+4*cos(tb+2*t1+t2)+6*cos(tb-t3)...
    +3*cos(tb-t2-t3)+6*cos(tb+t3)+3*cos(tb+2*t1+t2+t3)+2*cos(tb-t4)...
    +2*cos(tb-t3-t4)+cos(tb-t2-t3-t4)+2*cos(tb+t4)+2*cos(tb+t3+t4)...
    +cos(tb+2*t1+t2+t3+t4))*tbd-4*sin(tb/2)*(4*sin(tb/2+2*t1+t2)...
    +3*sin(tb/2+2*t1+t2+t3)+sin(tb/2+2*t1+t2+t3+t4))*t1d...
    -6*cos(tb-t2)*t2d-4*cos(t2)*t2d-4*cos(2*t1+t2)*t2d...
    +4*cos(tb+2*t1+t2)*t2d-3*cos(tb-t2-t3)*t2d-3*cos(t2+t3)*t2d...
    -3*cos(2*t1+t2+t3)*t2d+3*cos(tb+2*t1+t2+t3)*t2d-cos(tb-t2-t3-t4)*t2d...
    -cos(t2+t3+t4)*t2d-cos(2*t1+t2+t3+t4)*t2d+cos(tb+2*t1+t2+t3+t4)*t2d...
    -6*cos(tb-t3)*t3d-3*cos(tb-t2-t3)*t3d+6*cos(tb+t3)*t3d...
    -3*cos(t2+t3)*t3d-3*cos(2*t1+t2+t3)*t3d+3*cos(tb+2*t1+t2+t3)*t3d...
    -2*cos(tb-t3-t4)*t3d-cos(tb-t2-t3-t4)*t3d+2*cos(tb+t3+t4)*t3d...
    -cos(t2+t3+t4)*t3d-cos(2*t1+t2+t3+t4)*t3d+cos(tb+2*t1+t2+t3+t4)*t3d...
    -2*cos(tb-t4)*t4d-2*cos(tb-t3-t4)*t4d-cos(tb-t2-t3-t4)*t4d...
    +2*cos(tb+t4)*t4d+2*cos(tb+t3+t4)*t4d-cos(t2+t3+t4)*t4d...
    -cos(2*t1+t2+t3+t4)*t4d+cos(tb+2*t1+t2+t3+t4)*t4d);
% Coriolis Effect on Theta due to th3_dot
C36 = 1/4*l^2*m*((6*cos(tb)+6*cos(tb-t3)+3*cos(tb-t2-t3)...
    +3*cos(tb+2*t1+t2+t3)+2*cos(tb-t4)+2*cos(tb-t3-t4)+cos(tb-t2-t3-t4)...
    +2*cos(tb+t4)+cos(tb+2*t1+t2+t3+t4))*tbd-4*sin(tb/2)*(3*sin(tb/2+2*t1+t2+t3)...
    +sin(tb/2+2*t1+t2+t3+t4))*t1d-3*cos(tb-t2-t3)*t2d-3*cos(t2+t3)*t2d...
    -3*cos(2*t1+t2+t3)*t2d+3*cos(tb+2*t1+t2+t3)*t2d-cos(tb-t2-t3-t4)*t2d...
    -cos(t2+t3+t4)*t2d-cos(2*t1+t2+t3+t4)*t2d+cos(tb+2*t1+t2+t3+t4)*t2d...
    -6*cos(tb-t3)*t3d-3*cos(tb-t2-t3)*t3d-3*cos(t2+t3)*t3d...
    -3*cos(2*t1+t2+t3)*t3d+3*cos(tb+2*t1+t2+t3)*t3d-2*cos(tb-t3-t4)*t3d...
    -cos(tb-t2-t3-t4)*t3d-cos(t2+t3+t4)*t3d-cos(2*t1+t2+t3+t4)*t3d...
    +cos(tb+2*t1+t2+t3+t4)*t3d-2*cos(tb-t4)*t4d-2*cos(tb-t3-t4)*t4d...
    -cos(tb-t2-t3-t4)*t4d+2*cos(tb+t4)*t4d-cos(t2+t3+t4)*t4d...
    -cos(2*t1+t2+t3+t4)*t4d+cos(tb+2*t1+t2+t3+t4)*t4d);
% Coriolis Effect on Theta due to th4_dot
C37 = 1/4*l^2*m*((cos(tb)+2*cos(tb-t4)+2*cos(tb-t3-t4)+cos(tb-t2-t3-t4)...
    +cos(tb+2*t1+t2+t3+t4))*tbd-4*sin(tb/2)*sin(tb/2+2*t1+t2+t3+t4)*t1d...
    -cos(tb-t2-t3-t4)*t2d-cos(t2+t3+t4)*t2d-cos(2*t1+t2+t3+t4)*t2d...
    +cos(tb+2*t1+t2+t3+t4)*t2d-2*cos(tb-t3-t4)*t3d-cos(tb-t2-t3-t4)*t3d...
    -cos(t2+t3+t4)*t3d-cos(2*t1+t2+t3+t4)*t3d+cos(tb+2*t1+t2+t3+t4)*t3d...
    -2*cos(tb-t4)*t4d-2*cos(tb-t3-t4)*t4d-cos(tb-t2-t3-t4)*t4d...
    -cos(t2+t3+t4)*t4d-cos(2*t1+t2+t3+t4)*t4d+cos(tb+2*t1+t2+t3+t4)*t4d);

%% Coriolis Effect on Theta1 
% Coriolis Effect on Theta1 due to x_dot
C41 = -(1/4)*l*m*((7*sin(t1)+5*sin(t1+t2)+3*sin(t1+t2+t3)...
    +sin(t1+t2+t3+t4))*t1d+(5*sin(t1+t2)+3*sin(t1+t2+t3)...
    +sin(t1+t2+t3+t4))*t2d+3*sin(t1+t2+t3)*t3d+sin(t1+t2+t3+t4)*t3d...
    +sin(t1+t2+t3+t4)*t4d);
% Coriolis Effect on Theta1 due to y_dot
C42 = -(1/4)*l*m*((7*cos(t1)+5*cos(t1+t2)+3*cos(t1+t2+t3)...
    +cos(t1+t2+t3+t4))*t1d+(5*cos(t1+t2)+3*cos(t1+t2+t3)...
    +cos(t1+t2+t3+t4))*t2d+3*cos(t1+t2+t3)*t3d...
    +cos(t1+t2+t3+t4)*t3d+cos(t1+t2+t3+t4)*t4d);
% Coriolis Effect on Theta1 due to Theta_dot
C43 = 1/4*l^2*m*((24*cos(tb)+4*cos(tb+2*t1)+6*cos(tb-t2)+10*cos(tb+t2)...
    +4*cos(tb+2*t1+t2)+6*cos(tb-t3)+3*cos(tb-t2-t3)+6*cos(tb+t3)...
    +6*cos(tb+t2+t3)+3*cos(tb+2*t1+t2+t3)+2*cos(tb-t4)+2*cos(tb-t3-t4)...
    +cos(tb-t2-t3-t4)+2*cos(tb+t4)+2*cos(tb+t3+t4)+2*cos(tb+t2+t3+t4)...
    +cos(tb+2*t1+t2+t3+t4))*tbd-2*sin(tb/2)*((4*sin(1/2*(tb+4*t1))...
    +4*sin(tb/2+2*t1+t2)+3*sin(tb/2+2*t1+t2+t3)+sin(tb/2+2*t1+t2+t3+t4))*t1d...
    -(6*sin(1/2*(tb-2*t2))-10*sin(tb/2+t2)-6*sin(tb/2+t2+t3)...
    +3*sin(1/2*(tb-2*(t2+t3)))-2*sin(tb/2+t2+t3+t4)...
    +sin(1/2*(tb-2*(t2+t3+t4))))*t2d-6*sin(1/2*(tb-2*t3))*t3d...
    +6*sin(tb/2+t3)*t3d+6*sin(tb/2+t2+t3)*t3d-3*sin(1/2*(tb-2*(t2+t3)))*t3d...
    +2*sin(tb/2+t3+t4)*t3d+2*sin(tb/2+t2+t3+t4)*t3d...
    -2*sin(1/2*(tb-2*(t3+t4)))*t3d-sin(1/2*(tb-2*(t2+t3+t4)))*t3d...
    -2*sin(1/2*(tb-2*t4))*t4d+2*sin(tb/2+t4)*t4d+2*sin(tb/2+t3+t4)*t4d...
    +2*sin(tb/2+t2+t3+t4)*t4d-2*sin(1/2*(tb-2*(t3+t4)))*t4d...
    -sin(1/2*(tb-2*(t2+t3+t4)))*t4d));
% Coriolis Effect on Theta1 due to th1_dot
C44 = 1/4*l*m*(2*l*sin(tb/2)*(4*sin(1/2*(tb+4*t1))+4*sin(tb/2+2*t1+t2)...
    +3*sin(tb/2+2*t1+t2+t3)+sin(tb/2+2*t1+t2+t3+t4))*tbd-4*l*(5*sin(t2)...
    +3*sin(t2+t3)+sin(t2+t3+t4))*t2d-12*l*sin(t3)*t3d-12*l*sin(t2+t3)*t3d...
    -4*l*sin(t3+t4)*t3d-4*l*sin(t2+t3+t4)*t3d-4*l*sin(t4)*t4d...
    -4*l*sin(t3+t4)*t4d-4*l*sin(t2+t3+t4)*t4d+7*sin(t1)*xd+5*sin(t1+t2)*xd...
    +3*sin(t1+t2+t3)*xd+sin(t1+t2+t3+t4)*xd+7*cos(t1)*yd+5*cos(t1+t2)*yd...
    +3*cos(t1+t2+t3)*yd+cos(t1+t2+t3+t4)*yd);
% Coriolis Effect on Theta1 due to th2_dot
C45 = 1/4*l*m*(2*l*sin(tb/2)*(4*sin(tb/2+2*t1+t2)+3*sin(tb/2+2*t1+t2+t3)...
    +sin(tb/2+2*t1+t2+t3+t4))*tbd-2*l*(5*sin(t2)+3*sin(t2+t3)...
    +sin(t2+t3+t4))*t2d-12*l*sin(t3)*t3d-6*l*sin(t2+t3)*t3d...
    -4*l*sin(t3+t4)*t3d-2*l*sin(t2+t3+t4)*t3d-4*l*sin(t4)*t4d...
    -4*l*sin(t3+t4)*t4d-2*l*sin(t2+t3+t4)*t4d+5*sin(t1+t2)*xd...
    +3*sin(t1+t2+t3)*xd+sin(t1+t2+t3+t4)*xd+5*cos(t1+t2)*yd...
    +3*cos(t1+t2+t3)*yd+cos(t1+t2+t3+t4)*yd);
% Coriolis Effect on Theta1 due to th3_dot
C46 = -(1/4)*l*m*(-2*l*sin(tb/2)*(3*sin(tb/2+2*t1+t2+t3)...
    +sin(tb/2+2*t1+t2+t3+t4))*tbd+2*l*(3*sin(t2+t3)+sin(t2+t3+t4))*t2d...
    +6*l*sin(t3)*t3d+6*l*sin(t2+t3)*t3d+2*l*sin(t3+t4)*t3d...
    +2*l*sin(t2+t3+t4)*t3d+4*l*sin(t4)*t4d+2*l*sin(t3+t4)*t4d...
    +2*l*sin(t2+t3+t4)*t4d-3*sin(t1+t2+t3)*xd-sin(t1+t2+t3+t4)*xd...
    -3*cos(t1+t2+t3)*yd-cos(t1+t2+t3+t4)*yd);
% Coriolis Effect on Theta1 due to th4_dot
C47 = 1/4*l*m*(2*l*sin(tb/2)*sin(tb/2+2*t1+t2+t3+t4)*tbd...
    -2*l*sin(t2+t3+t4)*t2d-2*l*sin(t3+t4)*t3d-2*l*sin(t2+t3+t4)*t3d...
    -2*l*sin(t4)*t4d-2*l*sin(t3+t4)*t4d-2*l*sin(t2+t3+t4)*t4d...
    +sin(t1+t2+t3+t4)*xd+cos(t1+t2+t3+t4)*yd);
%% Coriolis Effect on Theta2
% Coriolis Effect on Theta2 due to x_dot
C51 = -(1/4)*l*m*((5*sin(t1+t2)+3*sin(t1+t2+t3)+sin(t1+t2+t3+t4))*t1d...
    +(5*sin(t1+t2)+3*sin(t1+t2+t3)+sin(t1+t2+t3+t4))*t2d...
    +3*sin(t1+t2+t3)*t3d+sin(t1+t2+t3+t4)*t3d+sin(t1+t2+t3+t4)*t4d);
% Coriolis Effect on Theta2 due to y_dot
C52 = -(1/4)*l*m*((5*cos(t1+t2)+3*cos(t1+t2+t3)+cos(t1+t2+t3+t4))*t1d...
    +(5*cos(t1+t2)+3*cos(t1+t2+t3)+cos(t1+t2+t3+t4))*t2d...
    +3*cos(t1+t2+t3)*t3d+cos(t1+t2+t3+t4)*t3d+cos(t1+t2+t3+t4)*t4d);
% Coriolis Effect on Theta2 due to theta_dot
C53 = 1/8*l^2*m*(2*(15*cos(tb)+6*cos(tb-t2)+4*cos(tb+2*t1+t2)+6*cos(tb-t3)...
    +3*cos(tb-t2-t3)+6*cos(tb+t3)+3*cos(tb+2*t1+t2+t3)+2*cos(tb-t4)...
    +2*cos(tb-t3-t4)+cos(tb-t2-t3-t4)+2*cos(tb+t4)+2*cos(tb+t3+t4)...
    +cos(tb+2*t1+t2+t3+t4))*tbd-2*sin(tb/2)*(6*sin(1/2*(tb-2*t2))...
    -10*sin(tb/2+t2)+12*sin(tb/2+2*t1+t2)-6*sin(tb/2+t2+t3)...
    +9*sin(tb/2+2*t1+t2+t3)+3*sin(1/2*(tb-2*(t2+t3)))-2*sin(tb/2+t2+t3+t4)...
    +3*sin(tb/2+2*t1+t2+t3+t4)+sin(1/2*(tb-2*(t2+t3+t4))))*t1d...
    -6*cos(tb-t2)*t2d-4*cos(t2)*t2d-4*cos(2*t1+t2)*t2d...
    +4*cos(tb+2*t1+t2)*t2d-3*cos(tb-t2-t3)*t2d-3*cos(t2+t3)*t2d...
    -3*cos(2*t1+t2+t3)*t2d+3*cos(tb+2*t1+t2+t3)*t2d-cos(tb-t2-t3-t4)*t2d...
    -cos(t2+t3+t4)*t2d-cos(2*t1+t2+t3+t4)*t2d+cos(tb+2*t1+t2+t3+t4)*t2d...
    -12*cos(tb-t3)*t3d-3*cos(tb-t2-t3)*t3d+12*cos(tb+t3)*t3d-3*cos(t2+t3)*t3d...
    -3*cos(2*t1+t2+t3)*t3d+3*cos(tb+2*t1+t2+t3)*t3d-4*cos(tb-t3-t4)*t3d...
    -cos(tb-t2-t3-t4)*t3d+4*cos(tb+t3+t4)*t3d-cos(t2+t3+t4)*t3d...
    -cos(2*t1+t2+t3+t4)*t3d+cos(tb+2*t1+t2+t3+t4)*t3d-4*cos(tb-t4)*t4d...
    -4*cos(tb-t3-t4)*t4d-cos(tb-t2-t3-t4)*t4d+4*cos(tb+t4)*t4d+4*cos(tb+t3+t4)*t4d...
    -cos(t2+t3+t4)*t4d-cos(2*t1+t2+t3+t4)*t4d+cos(tb+2*t1+t2+t3+t4)*t4d);
% Coriolis Effect on Theta2 due to Th1_dot
C54 = -(1/4)*l*m*(-l*sin(tb/2)*(-6*sin(1/2*(tb-2*t2))+10*sin(tb/2+t2)...
    +4*sin(tb/2+2*t1+t2)+6*sin(tb/2+t2+t3)+3*sin(tb/2+2*t1+t2+t3)...
    -3*sin(1/2*(tb-2*(t2+t3)))+2*sin(tb/2+t2+t3+t4)+sin(tb/2+2*t1+t2+t3+t4)...
    -sin(1/2*(tb-2*(t2+t3+t4))))*tbd-2*l*(5*sin(t2)+3*sin(t2+t3)...
    +sin(t2+t3+t4))*t1d+5*l*sin(t2)*t2d+3*l*sin(t2+t3)*t2d...
    +l*sin(t2+t3+t4)*t2d+12*l*sin(t3)*t3d+3*l*sin(t2+t3)*t3d...
    +4*l*sin(t3+t4)*t3d+l*sin(t2+t3+t4)*t3d+4*l*sin(t4)*t4d...
    +4*l*sin(t3+t4)*t4d+l*sin(t2+t3+t4)*t4d-5*sin(t1+t2)*xd...
    -3*sin(t1+t2+t3)*xd-sin(t1+t2+t3+t4)*xd-5*cos(t1+t2)*yd...
    -3*cos(t1+t2+t3)*yd-cos(t1+t2+t3+t4)*yd);
% Coriolis Effect on Theta2 due to Th2_dot
C55 = 1/8*l*m*(l*(6*cos(tb-t2)+4*cos(t2)+4*cos(2*t1+t2)-4*cos(tb+2*t1+t2)...
    +3*cos(tb-t2-t3)+3*cos(t2+t3)+3*cos(2*t1+t2+t3)-3*cos(tb+2*t1+t2+t3)...
    +cos(tb-t2-t3-t4)+cos(t2+t3+t4)+cos(2*t1+t2+t3+t4)-cos(tb+2*t1+t2+t3+t4))*tbd...
    +2*(l*(5*sin(t2)+3*sin(t2+t3)+sin(t2+t3+t4))*t1d-4*l*(3*sin(t3)...
    +sin(t3+t4))*t3d-4*l*sin(t4)*t4d-4*l*sin(t3+t4)*t4d+5*sin(t1+t2)*xd...
    +3*sin(t1+t2+t3)*xd+sin(t1+t2+t3+t4)*xd+5*cos(t1+t2)*yd...
    +3*cos(t1+t2+t3)*yd+cos(t1+t2+t3+t4)*yd));
% Coriolis Effect on Theta2 due to Th3_dot
C56 = 1/8*l*m*(l*(3*cos(tb-t2-t3)+3*cos(t2+t3)+3*cos(2*t1+t2+t3)...
    -3*cos(tb+2*t1+t2+t3)+cos(tb-t2-t3-t4)+cos(t2+t3+t4)...
    +cos(2*t1+t2+t3+t4)-cos(tb+2*t1+t2+t3+t4))*tbd+2*(l*(3*sin(t2+t3)...
    +sin(t2+t3+t4))*t1d-2*l*(3*sin(t3)+sin(t3+t4))*t3d-4*l*sin(t4)*t4d...
    -2*l*sin(t3+t4)*t4d+3*sin(t1+t2+t3)*xd+sin(t1+t2+t3+t4)*xd...
    +3*cos(t1+t2+t3)*yd+cos(t1+t2+t3+t4)*yd));
% Coriolis Effect on Theta2 due to Th4_dot
C57 = 1/8*l*m*(l*(cos(tb-t2-t3-t4)+cos(t2+t3+t4)...
    +2*sin(tb/2)*sin(tb/2+2*t1+t2+t3+t4))*tbd+2*(l*sin(t2+t3+t4)*t1d...
    -2*l*sin(t3+t4)*t3d-2*l*sin(t4)*t4d-2*l*sin(t3+t4)*t4d...
    +sin(t1+t2+t3+t4)*xd+cos(t1+t2+t3+t4)*yd));
%% Coriolis Effect on Theta3
% Coriolis Effect on Theta3 due to x_dot
C61 = -(1/4)*l*m*((3*sin(t1+t2+t3)+sin(t1+t2+t3+t4))*t1d...
    +(3*sin(t1+t2+t3)+sin(t1+t2+t3+t4))*t2d+3*sin(t1+t2+t3)*t3d...
    +sin(t1+t2+t3+t4)*t3d+sin(t1+t2+t3+t4)*t4d);
% Coriolis Effect on Theta3 due to y_dot
C62 = -(1/4)*l*m*((3*cos(t1+t2+t3)+cos(t1+t2+t3+t4))*t1d...
    +(3*cos(t1+t2+t3)+cos(t1+t2+t3+t4))*t2d+3*cos(t1+t2+t3)*t3d...
    +cos(t1+t2+t3+t4)*t3d+cos(t1+t2+t3+t4)*t4d);
% Coriolis Effect on Theta3 due to th_dot
C63 = 1/8*l^2*m*(2*(6*cos(tb)+6*cos(tb-t3)+3*cos(tb-t2-t3)...
    +3*cos(tb+2*t1+t2+t3)+2*cos(tb-t4)+2*cos(tb-t3-t4)...
    +cos(tb-t2-t3-t4)+2*cos(tb+t4)+cos(tb+2*t1+t2+t3+t4))*tbd...
    +(6*cos(tb-t3)+3*cos(tb-t2-t3)-6*cos(tb+t3)+3*cos(t2+t3)...
    -6*cos(tb+t2+t3)-9*cos(2*t1+t2+t3)+9*cos(tb+2*t1+t2+t3)...
    +2*cos(tb-t3-t4)+cos(tb-t2-t3-t4)-2*cos(tb+t3+t4)+cos(t2+t3+t4)...
    -2*cos(tb+t2+t3+t4)-3*cos(2*t1+t2+t3+t4)+3*cos(tb+2*t1+t2+t3+t4))*t1d...
    +6*cos(tb-t3)*t2d-3*cos(tb-t2-t3)*t2d-6*cos(tb+t3)*t2d-3*cos(t2+t3)*t2d...
    -3*cos(2*t1+t2+t3)*t2d+3*cos(tb+2*t1+t2+t3)*t2d+2*cos(tb-t3-t4)*t2d...
    -cos(tb-t2-t3-t4)*t2d-2*cos(tb+t3+t4)*t2d-cos(t2+t3+t4)*t2d...
    -cos(2*t1+t2+t3+t4)*t2d+cos(tb+2*t1+t2+t3+t4)*t2d-6*cos(tb-t3)*t3d...
    -3*cos(tb-t2-t3)*t3d-3*cos(t2+t3)*t3d-3*cos(2*t1+t2+t3)*t3d...
    +3*cos(tb+2*t1+t2+t3)*t3d-2*cos(tb-t3-t4)*t3d-cos(tb-t2-t3-t4)*t3d...
    -cos(t2+t3+t4)*t3d-cos(2*t1+t2+t3+t4)*t3d+cos(tb+2*t1+t2+t3+t4)*t3d...
    -4*cos(tb-t4)*t4d-2*cos(tb-t3-t4)*t4d-cos(tb-t2-t3-t4)*t4d...
    +4*cos(tb+t4)*t4d-cos(t2+t3+t4)*t4d-cos(2*t1+t2+t3+t4)*t4d...
    +cos(tb+2*t1+t2+t3+t4)*t4d);
% Coriolis Effect on Theta3 due to th1_dot
C64 = 1/4*l*m*(l*sin(tb/2)*(-6*sin(1/2*(tb-2*t3))+6*sin(tb/2+t3)...
    +6*sin(tb/2+t2+t3)+3*sin(tb/2+2*t1+t2+t3)-3*sin(1/2*(tb-2*(t2+t3)))...
    +2*sin(tb/2+t3+t4)+2*sin(tb/2+t2+t3+t4)+sin(tb/2+2*t1+t2+t3+t4)...
    -2*sin(1/2*(tb-2*(t3+t4)))-sin(1/2*(tb-2*(t2+t3+t4))))*tbd...
    +4*l*cos(t2/2)*(3*sin(t2/2+t3)+sin(t2/2+t3+t4))*t1d...
    +6*l*sin(t3)*t2d-3*l*sin(t2+t3)*t2d+2*l*sin(t3+t4)*t2d...
    -l*sin(t2+t3+t4)*t2d-3*l*sin(t3)*t3d-3*l*sin(t2+t3)*t3d...
    -l*sin(t3+t4)*t3d-l*sin(t2+t3+t4)*t3d-4*l*sin(t4)*t4d...
    -l*sin(t3+t4)*t4d-l*sin(t2+t3+t4)*t4d+3*sin(t1+t2+t3)*xd...
    +sin(t1+t2+t3+t4)*xd+3*cos(t1+t2+t3)*yd+cos(t1+t2+t3+t4)*yd);
% Coriolis Effect on Theta3 due to th2_dot
C65 = 1/8*l*m*(l*(6*cos(tb-t3)+3*cos(tb-t2-t3)-6*cos(tb+t3)+3*cos(t2+t3)...
    +3*cos(2*t1+t2+t3)-3*cos(tb+2*t1+t2+t3)+2*cos(tb-t3-t4)...
    +cos(tb-t2-t3-t4)-2*cos(tb+t3+t4)+cos(t2+t3+t4)+cos(2*t1+t2+t3+t4)...
    -cos(tb+2*t1+t2+t3+t4))*tbd+2*(l*(6*sin(t3)+3*sin(t2+t3)+2*sin(t3+t4)...
    +sin(t2+t3+t4))*t1d+2*l*(3*sin(t3)+sin(t3+t4))*t2d-3*l*sin(t3)*t3d...
    -l*sin(t3+t4)*t3d-4*l*sin(t4)*t4d-l*sin(t3+t4)*t4d+3*sin(t1+t2+t3)*xd...
    +sin(t1+t2+t3+t4)*xd+3*cos(t1+t2+t3)*yd+cos(t1+t2+t3+t4)*yd));
% Coriolis Effect on Theta3 due to th3_dot
C66 = 1/8*l*m*(l*(6*cos(tb-t3)+3*cos(tb-t2-t3)+3*cos(t2+t3)...
    +3*cos(2*t1+t2+t3)-3*cos(tb+2*t1+t2+t3)+2*cos(tb-t3-t4)...
    +cos(tb-t2-t3-t4)+cos(t2+t3+t4)+cos(2*t1+t2+t3+t4)...
    -cos(tb+2*t1+t2+t3+t4))*tbd+2*(2*l*cos(t2/2)*(3*sin(t2/2+t3)...
    +sin(t2/2+t3+t4))*t1d+l*(3*sin(t3)+sin(t3+t4))*t2d-4*l*sin(t4)*t4d...
    +3*sin(t1+t2+t3)*xd+sin(t1+t2+t3+t4)*xd+3*cos(t1+t2+t3)*yd...
    +cos(t1+t2+t3+t4)*yd));
% Coriolis Effect on Theta3 due to th_dot 
C67 = 1/8*l*m*(l*(2*cos(tb-t3-t4)+cos(tb-t2-t3-t4)+cos(t2+t3+t4)...
    +cos(2*t1+t2+t3+t4)-cos(tb+2*t1+t2+t3+t4))*tbd...
    +2*(l*(sin(t3+t4)+sin(t2+t3+t4))*t1d+l*sin(t3+t4)*t2d-2*l*sin(t4)*t4d...
    +sin(t1+t2+t3+t4)*xd+cos(t1+t2+t3+t4)*yd));

%% Coriolis Effect on Theta4
% Coriolis Effect on Theta4 due to x_dot
C71 = -(1/4)*l*m*sin(t1+t2+t3+t4)*(t1d+t2d+t3d+t4d);
% Coriolis Effect on Theta4 due to y_dot
C72 = -(1/4)*l*m*cos(t1+t2+t3+t4)*(t1d+t2d+t3d+t4d);
% Coriolis Effect on Theta4 due to th_dot
C73 = 1/8*l^2*m*(2*(cos(tb)+2*cos(tb-t4)+2*cos(tb-t3-t4)+cos(tb-t2-t3-t4)...
    +cos(tb+2*t1+t2+t3+t4))*tbd+(2*cos(tb-t4)+2*cos(tb-t3-t4)...
    +cos(tb-t2-t3-t4)-2*cos(tb+t4)-2*cos(tb+t3+t4)+cos(t2+t3+t4)...
    -2*cos(tb+t2+t3+t4)-3*cos(2*t1+t2+t3+t4)+3*cos(tb+2*t1+t2+t3+t4))*t1d...
    +2*cos(tb-t4)*t2d+2*cos(tb-t3-t4)*t2d-cos(tb-t2-t3-t4)*t2d...
    -2*cos(tb+t4)*t2d-2*cos(tb+t3+t4)*t2d-cos(t2+t3+t4)*t2d...
    -cos(2*t1+t2+t3+t4)*t2d+cos(tb+2*t1+t2+t3+t4)*t2d+2*cos(tb-t4)*t3d...
    -2*cos(tb-t3-t4)*t3d-cos(tb-t2-t3-t4)*t3d-2*cos(tb+t4)*t3d...
    -cos(t2+t3+t4)*t3d-cos(2*t1+t2+t3+t4)*t3d+cos(tb+2*t1+t2+t3+t4)*t3d...
    -2*cos(tb-t4)*t4d-2*cos(tb-t3-t4)*t4d-cos(tb-t2-t3-t4)*t4d...
    -cos(t2+t3+t4)*t4d-cos(2*t1+t2+t3+t4)*t4d+cos(tb+2*t1+t2+t3+t4)*t4d);
% Coriolis Effect on Theta4 due to th1_dot
C74 = 1/8*l*m*(l*(2*cos(tb-t4)+2*cos(tb-t3-t4)+cos(tb-t2-t3-t4)...
    -2*cos(tb+t4)-2*cos(tb+t3+t4)+cos(t2+t3+t4)-2*cos(tb+t2+t3+t4)...
    +cos(2*t1+t2+t3+t4)-cos(tb+2*t1+t2+t3+t4))*tbd+4*l*(sin(t4)...
    +sin(t3+t4)+sin(t2+t3+t4))*t1d+4*l*sin(t4)*t2d+4*l*sin(t3+t4)*t2d...
    -2*l*sin(t2+t3+t4)*t2d+4*l*sin(t4)*t3d-2*l*sin(t3+t4)*t3d...
    -2*l*sin(t2+t3+t4)*t3d-2*l*sin(t4)*t4d-2*l*sin(t3+t4)*t4d...
    -2*l*sin(t2+t3+t4)*t4d+2*sin(t1+t2+t3+t4)*xd+2*cos(t1+t2+t3+t4)*yd);
% Coriolis Effect on Theta4 due to th2_dot
C75 = 1/8*l*m*(l*(2*cos(tb-t4)+2*cos(tb-t3-t4)+cos(tb-t2-t3-t4)...
    -2*cos(tb+t4)-2*cos(tb+t3+t4)+cos(t2+t3+t4)+cos(2*t1+t2+t3+t4)...
    -cos(tb+2*t1+t2+t3+t4))*tbd+2*(l*(2*sin(t4)+2*sin(t3+t4)...
    +sin(t2+t3+t4))*t1d+2*l*(sin(t4)+sin(t3+t4))*t2d+2*l*sin(t4)*t3d...
    -l*sin(t3+t4)*t3d-l*sin(t4)*t4d-l*sin(t3+t4)*t4d+sin(t1+t2+t3+t4)*xd...
    +cos(t1+t2+t3+t4)*yd));
% Coriolis Effect on Theta4 due to th3_dot
C76 = 1/8*l*m*(l*(2*cos(tb-t4)+2*cos(tb-t3-t4)+cos(tb-t2-t3-t4)...
    -2*cos(tb+t4)+cos(t2+t3+t4)+cos(2*t1+t2+t3+t4)...
    -cos(tb+2*t1+t2+t3+t4))*tbd+2*(l*(2*sin(t4)+sin(t3+t4)...
    +sin(t2+t3+t4))*t1d+l*(2*sin(t4)+sin(t3+t4))*t2d+2*l*sin(t4)*t3d...
    -l*sin(t4)*t4d+sin(t1+t2+t3+t4)*xd+cos(t1+t2+t3+t4)*yd));
% Coriolis Effect on Theta4 due to th4_dot
C77 = 1/8*l*m*(l*(2*cos(tb-t4)+2*cos(tb-t3-t4)+cos(tb-t2-t3-t4)...
    +cos(t2+t3+t4)+cos(2*t1+t2+t3+t4)-cos(tb+2*t1+t2+t3+t4))*tbd...
    +2*(l*(sin(t4)+sin(t3+t4)+sin(t2+t3+t4))*t1d+l*(sin(t4)...
    +sin(t3+t4))*t2d+l*sin(t4)*t3d+sin(t1+t2+t3+t4)*xd...
    +cos(t1+t2+t3+t4)*yd));

%% Collecting it in one matrix
C = [C11,C12,C13,C14,C15,C16,C16;
     C21,C22,C23,C24,C25,C26,C27;
     C31,C32,C33,C34,C35,C36,C37;
     C41,C42,C43,C44,C45,C46,C47;
     C51,C52,C53,C54,C55,C56,C57;
     C61,C62,C63,C64,C65,C66,C67;
     C71,C72,C73,C74,C75,C76,C77;];
end

% First Row
%C11 = -l^2*m*((5 * sin(t2)+3*sin(t2+t3)+sin(t2+t3+t4))*t2d...
%       +(3*sin(t3)+3*sin(t2+t3)+sin(t3+t4)+sin(t2+t3+t4))*t3d...
%       +(sin(t4)+sin(t3+t4)+sin(t2+t3+t4)) * t4d);
%C12 = -(1/2)*l^2*m*((5*sin(t2)+3*sin(t2+t3)+sin(t2+t3+t4))*t2d...
%       +(6*sin(t3)+3*sin(t2+t3)+2*sin(t3+t4)+sin(t2+t3+t4))*t3d...
%       +(2*sin(t4)+2*sin(t3+t4)+sin(t2+t3+t4))*t4d);
%C13 = -(1/2)*l^2*m*((3*sin(t2+t3)+sin(t2+t3+t4))*t2d...
%      +(3*sin(t3)+3*sin(t2+t3)+sin(t3+t4)+sin(t2+t3+t4))*t3d...
%      +(2*sin(t4)+sin(t3+t4)+sin(t2+t3+t4))*t4d);
%C14 = -(1/2)*l^2*m*(sin(t2+t3+t4)*t2d...
%       +(sin(t3+t4)+sin(t2+t3+t4))*t3d...
%       +(sin(t4)+sin(t3+t4)+sin(t2+t3+t4))*t4d);

% Second Row
%C21 = 1/4*l^2*m*(2*(5*sin(t2)+3*sin(t2+t3)+sin(t2+t3+t4))*t1d...
%      -(5*sin(t2)+3*sin(t2+t3)+sin(t2+t3+t4))*t2d-12*sin(t3)*t3d...
%      -3*sin(t2+t3)*t3d-4*sin(t3+t4)*t3d-sin(t2+t3+t4)*t3d...
%      -4*sin(t4)*t4d-4*sin(t3+t4)*t4d-sin(t2+t3+t4)*t4d);
%C22 = 1/4*l^2*m*((5*sin(t2)+3*sin(t2+t3)+sin(t2+t3+t4))*t1d...
%      -4*((3*sin(t3)+sin(t3+t4))*t3d+(sin(t4)+sin(t3+t4))*t4d));
%C23 = 1/4*l^2*m*((3*sin(t2+t3)+sin(t2+t3+t4))*t1d...
%      -2*((3*sin(t3)+sin(t3+t4))*t3d+(2*sin(t4)+sin(t3+t4))*t4d));
%C24 = 1/4*l^2*m*(sin(t2+t3+t4)*t1d-2*(sin(t3+t4)*t3d...
%      +(sin(t4)+sin(t3+t4))*t4d));

% Thirst Row
%C31 = 1/4*l^2*m*(2*(3*sin(t3)+3*sin(t2+t3)+sin(t3+t4)...
%      +sin(t2+t3+t4))*t1d-(-6*sin(t3)+3*sin(t2+t3)-2*sin(t3+t4)...
%      +sin(t2+t3+t4))*t2d-3*sin(t3)*t3d-3*sin(t2+t3)*t3d-sin(t3+t4)*t3d...
%      -sin(t2+t3+t4)*t3d-4*sin(t4)*t4d-sin(t3+t4)*t4d-sin(t2+t3+t4)*t4d);
%C32 = 1/4*l^2*m*((6*sin(t3)+3*sin(t2+t3)+2*sin(t3+t4)...
%      +sin(t2+t3+t4))*t1d+2*(3*sin(t3)+sin(t3+t4))*t2d-3*sin(t3)*t3d...
%      -sin(t3+t4)*t3d-4*sin(t4)*t4d-sin(t3+t4)*t4d);
%C33 = 1/4*l^2*m*((3*sin(t3)+3*sin(t2+t3)+sin(t3+t4)+sin(t2+t3+t4))*t1d...
%      +(3*sin(t3)+sin(t3+t4))*t2d-4*sin(t4)*t4d);
%C34 = 1/4*l^2*m*((sin(t3+t4)+sin(t2+t3+t4))*t1d...
%      +sin(t3+t4)*t2d-2*sin(t4)*t4d);

% Fourth Row
%C41 = 1/4*l^2*m*(2*(sin(t4)+sin(t3+t4)+sin(t2+t3+t4))*t1d...
%      +(2*sin(t4)+2*sin(t3+t4)-sin(t2+t3+t4))*t2d+2*sin(t4)*t3d...
%      -sin(t3+t4)*t3d-sin(t2+t3+t4)*t3d-sin(t4)*t4d-sin(t3+t4)*t4d...
%      -sin(t2+t3+t4)*t4d);
%C42 = 1/4*l^2*m*((2*sin(t4)+2*sin(t3+t4)+sin(t2+t3+t4))*t1d+2*(sin(t4)...
%      +sin(t3+t4))*t2d+2*sin(t4)*t3d-sin(t3+t4)*t3d-sin(t4)*t4d...
%      -sin(t3+t4)*t4d);
%C43 = 1/4*l^2*m*((2*sin(t4)+sin(t3+t4)+sin(t2+t3+t4))*t1d...
%      +(2*sin(t4)+sin(t3+t4))*t2d+sin(t4)*(2*t3d-t4d));
%C44 = 1/4*l^2*m*((sin(t4)+sin(t3+t4)+sin(t2+t3+t4))*t1d...
%      +(sin(t4)+sin(t3+t4))*t2d+sin(t4)*t3d);
